tests imported and adapted from the GHC testsuite

